input <- c("........#..#.##.#..............",
           "...#...............#.#.........",
           "...#..#...#..##....#...........",
           "...#.............#....#.....#..",
           "..#......#..#...#.......#......",
           "..............##...............",
           "#.......#.........#......#....#",
           ".#.....###.....#...#.#.#...#...",
           "#.....................#....#.#.",
           ".......#...................#...",
           "...#.#...................#....#",
           "....#....#.......#...#.........",
           "..##.#............#..#.........",
           ".....##.#..............##..###.",
           "...........#....#....#.........",
           "#.....#...#...#.#.#.#.##.#...#.",
           ".#...............#....##.......",
           ".....#..#......#....#.......##.",
           ".....#........#.......#........",
           "...#...##...#..##...#.....##...",
           ".....#.........#.###...##...#..",
           ".#.##...#........#.#.#.#....#..",
           "....#......##.#...#.....#....#.",
           ".......###..........#..#..#....",
           "......#...#.##.................",
           "....#...#...#.........#......#.",
           ".....#...........#...###....#..",
           ".....#...#.#.#....##.#......#.#",
           "......#...#.....#..#..#........",
           "#......#..#...##........###....",
           "##.....#....##..#.#.###.#...#..",
           "........#....#.......#.....#..#",
           "#.#.#.##.#.#...................",
           "..#...##....#......#.....##....",
           ".......#.##..#........##..#....",
           ".#.#....##......#.#..........#.",
           "#..............#............#..",
           ".#.#.#.#.#.####.#.#...##.......",
           ".#..#.....##.#.......#.##...#..",
           "..#.#........#.............#.#.",
           "..#.#..........#..#........#...",
           "..#..#...#.......##...#.#....##",
           "...#.....#.#.#.....#....#....#.",
           ".#...#......#.....#..##........",
           "...#.......##.#.#.....#......#.",
           "...........#.....#.#.......#...",
           "#...........#...#..#.#........#",
           "....#......#..##........#..###.",
           ".#..#........................#.",
           "#.......#......#...#...#..#....",
           "....#.#...#..#.#....#....##.#..",
           ".....#......#..#..........##.#.",
           ".#.....#...........#.........#.",
           "...###.#...#.......#.#.........",
           ".......#....#..........#..#...#",
           "......##..#.......#...##.......",
           "..#..........#.......#.........",
           "..........#..#..#..#..#........",
           ".#.................####...#.#.#",
           "..##.....#............#........",
           "....#.....###...#......#....#.#",
           "...##.#...........#.##......#..",
           "#..##..#..#....#...#..#........",
           "......#....#........#.......#..",
           "......#.....#......###.........",
           ".#.....#.#......#.......#......",
           "..#.........#..#..#........##.#",
           "..#.#....#.....#....##....#.#..",
           "...#.............##............",
           "........#..#..#......#...#.....",
           ".....#.#...#...##.....#.....#..",
           ".#..#.#..........##...##.....#.",
           "......##.#..........#...#.....#",
           "#.#.##......#....#..........#..",
           "................#.......#.##...",
           "#.......#.....#.......#....#...",
           "#..#.....#.##..##...........#..",
           ".....#....#.#.##..........#..##",
           "#.......#.....#.##...........#.",
           "........#.##........###..#.#...",
           "........#..................#...",
           "#.........................#...#",
           "....#.........#...#.#..#.....#.",
           ".#............#....#...........",
           "..#.#...#..##...#.#.......#....",
           ".#.#....#...........#.........#",
           "...#.#..........#.....#...#....",
           "......#....#.#...............##",
           "....##......###...##.##.....##.",
           "............#.#....#.#.....#..#",
           ".....#..#.....#.#...###....#...",
           ".......##....##..#...##..#...##",
           ".....#.......##..#...#...#....#",
           "#.........##....#........###.#.",
           "...#..##...#...#.........#.#.#.",
           "....#.#.....#.....#............",
           "#........#....#..#........#....",
           ".......#....#...#..............",
           "#...#.........##.....###.#.....",
           ".#....##..#...#..##.........#..",
           "....#.....#......##..#..#....#.",
           "#.#..#.........#........#......",
           "..#.......#.........#.....###..",
           "..#..........#...........#....#",
           "..#...............#......#..#..",
           "....#..#...#....###.....#..#..#",
           "#...#...#..#...........#....#..",
           ".#....#.#..#....#.#...........#",
           ".....#.....#..#....#..#....#...",
           "#.#..#...........#.#...........",
           "..................#.#.......#..",
           "...#.........#.....#..##....#..",
           ".........#.#...#.........##....",
           "...#..#....#.....#...#..#......",
           ".#.##.....#....#....#......##..",
           "##..#.........#.#....#...#.....",
           "#......#.#...#....#.#..#.......",
           ".......#.....#.....###....#.#..",
           ".#....##.#.....#...#.......#...",
           ".#.......#..#...#......#..#..##",
           "...............#...#...........",
           "#..............#....#.#.#....#.",
           "...........#..#.......#.##..#..",
           "..#......#.#....#...#.#.....#..",
           "#..............................",
           "#..#....#..........#...#.......",
           "......#.............#####......",
           ".#...###......#.#.#.##..#......",
           "............#.##.....#.........",
           ".........#....##....#..........",
           "###....#......#.......#........",
           ".#.......##..........#..#....#.",
           "#..#.....................#....#",
           "........#...........#..........",
           "..#..........#...#..#.........#",
           "..#..#......##................#",
           ".....##..#...#..#..............",
           ".......#...##..#...............",
           ".......##..#.####....#....#.#..",
           "#.#..#..........#........##....",
           "....##....#.#..#....#.#...#....",
           "......#.......#...#.....#...#..",
           "..#..#...#.....#.......###.....",
           "...#.......#.#.#.......#.##....",
           "...............#..#.#........#.",
           ".#....###.#......#.............",
           ".#..#...#....#.#..#.....#......",
           ".......#.##....#.#.##.##...#.#.",
           "..#...#....#.#..##.#.....#...##",
           "..#...#......#...#......#...#..",
           "....#..#...#.#..#......#.......",
           "#..#...............#......#.##.",
           ".#....#...#..........#.#.....#.",
           ".#..#.#.#................#..#..",
           ".#....#.#...#..##.###..#...###.",
           "#.............#.....#.........#",
           "...#.........#...#.......#..#..",
           "......#..#.........#..........#",
           "........##................#..#.",
           "......#...#.#.....#......##....",
           "...............#...#....#......",
           "...#.#..#..#.....##.###..##..#.",
           ".#....##......#...#..##..#.....",
           ".....#.........##.##....#...#..",
           ".....#.#..................####.",
           "#.....#...#.............##....#",
           "#.#..........#...#..#..#.......",
           "#..#.#.........#...............",
           "....#...#.........#...##.......",
           "...........#.....#..##..#......",
           "#.....#.......#.#........#.....",
           "..##..#.....#...##......#......",
           "....#....#.....................",
           "............#......#.........##",
           ".....##.............#.....##..#",
           ".......#.............#..#.#.##.",
           ".###...#......#..#........##.#.",
           "..#.#...#.#....#.....#..#......",
           "..#.#..#.##........#...#.......",
           "........#.#...............#..#.",
           "........##.......#...#.......#.",
           "...#........##.#..........#.#.#",
           "..#..###.#.#.......#.#......#..",
           "....#..........#...#..#........",
           "...#..#...#...#.#....#...#..#..",
           "...#...#........#......##...#.#",
           "#...........#..........#..#.##.",
           "...#..##..................#.#..",
           "...##.#...#....#.#...#.####....",
           ".....#...#.#.#..#..............",
           ".....#..#.#.#..#...............",
           "..#..#..##...#.#..#.....##....#",
           ".......#.#..#.....#....#.......",
           "...#..#....#.........#...#.....",
           "..............#.#...#...##.....",
           "...................#...........",
           ".#......#.#...................#",
           ".##.....#........#.........#..#",
           ".##..##...#...................#",
           "...#....#.#..#.#.#..#.....##...",
           ".......#..#....#......####.#...",
           ".##..#..##....#.......#........",
           ".#...#...........##............",
           ".....#.....#........#..........",
           "....##..#....#.....#...........",
           ".#...#....................#....",
           "....#.........#.......##.....#.",
           ".#....#..#.....#.##....#.......",
           "....#..#.........#.#....#.#....",
           ".......#.........##....#.......",
           "..#......#....#....#...#.......",
           "........#..#.......#.##......#.",
           "..#.....#......#...#..#.......#",
           "#..#.....##...#...#............",
           ".......##.......#........#...#.",
           "..#......................#...#.",
           "....##.#.............#......#..",
           "#.#............................",
           "...##.#.....#.#............#.##",
           "......#...#..#.........##......",
           ".#.......#.....##.......#.#....",
           "...........#.#.........#..##...",
           "...#..........#.##....#........",
           "........#..#..#...#....#....#..",
           "........##....#.#....#........#",
           "..#........##....###....#......",
           "#................###...#...#...",
           "................#.#..###......#",
           "..#.....##.#................#..",
           ".....#...............#..#......",
           "..#.......####.....#..#.#....##",
           "..#.....#..#....#..............",
           "#.#...........#.#.....#..##....",
           "#.#..........#.......#...#.###.",
           "........#....#...#..#.#........",
           ".#.....#......#..#..#..###..#..",
           ".#.........#.##.#.#......##....",
           "..#.........#...##..#........#.",
           ".#...................#.........",
           "...#.#........#................",
           "............#.....#..##........",
           "..#.....#.#......#.......#...#.",
           "........#....##..##...#.....##.",
           ".#........#.#....#.#....#.#..#.",
           "#.#.......#....................",
           ".#..#...##.........#..#........",
           ".........#...............#.....",
           "...#...#.....#......#.......#..",
           "###......................#.#..#",
           "...#.....####........#..#.....#",
           "#.#...#.#...................##.",
           ".........#.....................",
           "#..........##..#.....#....#....",
           ".......#...#.#.##.#..##........",
           "..........#..#.#..#.#.......#.#",
           ".....................#.#...#...",
           "...........#.#........#.#.#....",
           ".......#......#........#...#.#.",
           ".........#....................#",
           ".##.##....#...#.#.#.#..........",
           "#....##..#.##....#....#.......#",
           ".##.#...#...............#....#.",
           ".......#...#.###....#..........",
           ".....#....#...#..#.............",
           "#.........#.##....#.#.#........",
           "..#...#.............##..#..#...",
           "#..##.......#..........#...#.#.",
           ".#..#.....#...........#......#.",
           "......#......#..............##.",
           ".#...#..#...#..####.....#.....#",
           "....##.......#..........##.....",
           ".#.....#.......#.....#.#...#...",
           "..#..#..#.#...#......#.........",
           "......#.#....#........#.......#",
           "........#.......#..............",
           "..#...#.#....#........#.......#",
           "............#....#...##.#......",
           ".........#.............#..#....",
           "#.............#.#..##.......#..",
           "#....#...........###....#......",
           "...#.....................#.....",
           "....#.#..........#...#.......#.",
           "......#..#.......#...#...#....#",
           ".#.#..#.....##.#........#......",
           "...........#...#.#.............",
           "...###............#...#..#.....",
           "..#.#.......#...#.#..#.........",
           ".#......##...........#.....#.##",
           ".....##.....#....##...##.#.#...",
           "..........#.#.#......#........#",
           "..#.#........#....##....#.#....",
           ".#....#...##...........#....#..",
           "##......#...#.......#..........",
           ".##...###..#...#......#..##.#.#",
           "...........##.#..##...#.......#",
           "..#..............##............",
           "........#..#........#...#..#.#.",
           "..#.............#......#...##..",
           "#...##....#...#....#....#.#....",
           ".#.#......#..##............#.#.",
           ".....###.#....##....#....#.....",
           "#.#.#..........#...#...#.#.#...",
           ".....#.#...........####........",
           ".....#....##...#.##..#......#..",
           "#....#.......#.##.......#..#...",
           ".....#.....#........#..........",
           ".......#.......#...#.##......#.",
           "...#.........##...#.#.#......##",
           "#........#........#...#..#.....",
           ".#......#.#......#.#...#....#..",
           "#..#....##.....##..............",
           "...#.##............#..........#",
           ".....#.#....#..#.#............#",
           "..#......#...###.##.......###..",
           "........#....#.#.#.#...........",
           "............#..#........#.....#",
           "....#...............#..........",
           "......#....#....###..#.......##",
           "#...#...##....#.........#...#..",
           "...........#.#.............#...",
           "...#..#.....#..##.#....#......#",
           "..#...#..#...#......#..........",
           "....#..#....#.......#........#.")

library(tidyverse)

# Part 1
traversed_points_x <- ((seq(0, length(input) - 1) * 3) %% nchar(input[1])) + 1
traversed_points <- substr(input, traversed_points_x, traversed_points_x)
sum(traversed_points == "#")

# Part 2
down = c(1, 1, 1, 1, 2)
right = c(1, 3, 5, 7, 1)

tree_counter <- function(down, right, input) {
  traversed_points_y <- seq(1, length(input), by = down)
  traversed_points_x <- ((seq(0, length(traversed_points_y) - 1) * right) %% nchar(input[1])) + 1
  traversed_points <- substr(input[traversed_points_y], traversed_points_x, traversed_points_x)
  sum(traversed_points == "#")
}

map2(down, right, ~tree_counter(.x, .y, input)) %>% reduce(`*`)


